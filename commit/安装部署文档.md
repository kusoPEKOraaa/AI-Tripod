# AI-Tripod（ModelVerse）安装部署文档（简版）

## 1. 项目说明

本项目为基于 FastAPI 的 Web 应用，提供模型管理、推理部署、训练微调与评估等功能。

## 2. 部署环境

### 2.1 基础环境（必需）
- 操作系统：Linux（Ubuntu 20.04+）或 WSL2
- Python：3.10+

### 2.2 GPU/推理训练环境（按需）
- NVIDIA Driver：525+
- CUDA：12.x

> 说明：仅做页面演示/接口联调可在无 GPU 环境启动；训练/推理相关能力需要 GPU 与对应依赖。
>
> 重要：**部分依赖会因服务器 CUDA 版本不同而变化**（尤其是 `torch/torchvision/torchaudio`、`vllm` 等），`requirements-all.txt` 在不同 CUDA 环境下可能需要调整安装方式或版本组合。

## 3. 安装与启动

以下命令以项目根目录为起点（即包含 `modelverse/` 的目录）。

### 3.1 创建虚拟环境并安装依赖

```bash
python3 -m venv .venv
source .venv/bin/activate

# 二选一：
pip install -r requirements-all.txt
# 或（更轻量，但可能缺少训练/推理重依赖）：
# pip install -r modelverse/requirements.txt
```

#### 3.1.1 CUDA 差异导致的依赖调整（必读）

不同服务器常见差异：CUDA Toolkit 版本（如 11.8/12.1/12.4/12.8）、驱动版本、GPU 架构与是否能编译扩展。

建议做法：

1) **先按服务器 CUDA 选择并安装 PyTorch 对应轮子**（不要让 `requirements-all.txt` 自动拉取不匹配版本）  
示例（按需选择其一）：

```bash
# CUDA 12.8
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128

# CUDA 12.4
# pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124

# CUDA 12.1
# pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121

# CUDA 11.8
# pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

2) **再安装项目其它依赖**：

```bash
pip install -r modelverse/requirements.txt
```

3) 如需启用推理/训练组件，再按 PyTorch 版本选择兼容的 `vllm` / `oumi[gpu]`。若安装报错，通常需要：
- 降/升 PyTorch 与 CUDA 轮子组合
- 选择与当前 PyTorch 兼容的 `vllm` 版本
- 或在无 GPU 环境暂不安装 `vllm`，仅启动 Web/API（基础功能）

### 3.2 初始化数据库（可选）

系统首次启动会自动建表并创建默认管理员账号；也可手动初始化：

```bash
bash commit/scripts/init_sqlite.sh
```

### 3.3 启动服务

```bash
bash commit/scripts/start_server.sh
```

## 4. 外部可访问入口（部署后）

假设服务端 IP 为 `<SERVER_IP>`：

- 系统首页（前端页面）：`http://<SERVER_IP>:8888/`
- API 文档（Swagger）：`http://<SERVER_IP>:8888/docs`

端口可在启动脚本中修改（默认 `8888`）。

## 5. 典型系统用户

- 管理员（默认内置）：用户名 `admin`，密码 `admin123`
- 普通用户：可通过页面注册/由管理员创建（按系统实现为准）

> 生产环境建议修改默认密码，并限制对外暴露端口的访问范围。

## 6. 提交交付物清单（本目录）

- 部署包：`commit/deploy/modelverse-src.tar.gz`
- 数据库脚本：`commit/db/sqlite_schema.sql`
- 样例数据：`commit/db/sample_export.json`
- 一键脚本：`commit/scripts/*.sh`
